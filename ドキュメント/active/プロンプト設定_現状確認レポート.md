# プロンプト設定 現状確認レポート

**確認日**: 2025年11月20日  
**問題**: 投稿がトレンド追いかけ型になっている

## 🔍 確認結果

### 1. データベースに保存されている設定

#### 曜日テーマ設定
```json
{
  "monday": "新しい週の始まり、今週の目標について",
  "tuesday": "仕事や学習のペース、生産性向上について",
  "wednesday": "週の中間点、進捗確認と調整について",
  "thursday": "もうすぐ週末、今週の成果と課題について",  ← 今日（木曜日）
  "friday": "週末前、今週の振り返りと来週の準備について",
  "saturday": "リラックス、趣味や休息について",
  "sunday": "週の終わり、内省と来週への準備について"
}
```

#### トーン設定
```json
{
  "politeness": 70,      // 丁寧さ
  "positivity": 75,      // ポジティブ度
  "casualness": 50,      // カジュアルさ
  "creativity": 65,      // 創造性
  "humorous": 40,        // ユーモア度
  "emotional": 55,       // 感情表現度
  "intellectual": 60     // 知的さ
}
```

#### プロンプト設定
```json
{
  "additional_rules": [
    "自然で親しみやすい文体を心がける",
    "ハッシュタグは#POSL_V1のみ使用",
    "280文字以内で簡潔にまとめる"
  ],
  "preferred_phrases": ["今日は", "ふと思った", "やっぱり", "なるほど"],
  "creativity_level": 70,
  "ng_words": []
}
```

### 2. 実際に使用されているプロンプト（問題点）

**エンドポイント**: `/dev/post/ai-with-x`（自動投稿で使用）

```javascript
// 現在のコード（simple_final_api.js 469-473行目）
const systemPrompt = `あなたはフィンテック・投資分析に特化したSNS投稿を生成するAIです。
280文字以内で、自然で前向きな投稿文を作成してください。
ハッシュタグは適切に使用してください。`;

const userPrompt = `今日のフィンテック・投資関連のトレンドを踏まえた投稿文を生成してください。`;
```

### 3. 問題点

❌ **データベースの設定が一切使われていない**
- 曜日テーマが反映されていない
- トーン設定が反映されていない
- プロンプト設定（additional_rules、preferred_phrases）が反映されていない
- テンプレート設定が反映されていない

❌ **固定のトレンド追いかけ型プロンプト**
- 「今日のフィンテック・投資関連のトレンドを踏まえた投稿文」という固定指示
- そのため、常にトレンド中心の投稿になってしまう

### 4. 期待される動作

✅ **データベースの設定を反映したプロンプト生成**
- 今日の曜日テーマ（木曜日: 「もうすぐ週末、今週の成果と課題について」）を反映
- トーン設定（丁寧さ70、ポジティブ度75など）を反映
- プロンプト設定（additional_rules、preferred_phrases）を反映
- トレンドは補助的に使用（設定に応じて）

## 💡 解決策

`/dev/post/ai-with-x`エンドポイントを修正して、データベースの設定を読み込んでプロンプトを構築する必要があります。

### 修正が必要な箇所

1. **設定の取得**: データベースから曜日テーマ、トーン、プロンプト設定を取得
2. **プロンプト構築**: 取得した設定を組み合わせてプロンプトを生成
3. **曜日判定**: 今日の曜日を判定して適切なテーマを選択

---

**ステータス**: 🔴 要修正  
**優先度**: 高（自動投稿の品質に直結）

