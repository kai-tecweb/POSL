# コード整理ガイド

**作成日**: 2025年11月20日  
**目的**: ローカルと本番環境の関係性を整理し、不要なコードをアーカイブ

## 📋 現在の状況

### 使用中のコード

1. **バックエンド**
   - `simple_final_api.js` (ルートディレクトリ) - **使用中**
   - Express.jsベースのAPIサーバー

2. **フロントエンド**
   - `frontend/` ディレクトリ - **使用中**
   - Next.js 14アプリケーション

3. **インフラ設定**
   - `infrastructure/` ディレクトリ - **使用中**
   - Nginx設定、MySQLスキーマなど

### 未使用のコード（アーカイブ対象）

1. **Lambda関数のコード**
   - `backend/src/functions/` - 24個のTypeScriptファイル
   - `backend/serverless.yml` - Serverless Framework設定
   - `backend/webpack.config.js` - Lambda用ビルド設定
   - **理由**: Express.js (`simple_final_api.js`) に完全移行済み

2. **DynamoDB関連のコード**
   - DynamoDB接続コード（既にMySQLに移行済み）
   - **理由**: RDS MySQL 8.0に完全移行済み

3. **ローカル開発用の設定（オプション）**
   - `docker-compose.yml` - ローカル開発用（本番では使用しない）
   - **理由**: 本番環境はEC2上で直接実行

## 🔄 整理方針

### アーカイブ対象

以下のディレクトリ・ファイルをアーカイブ：

```
ドキュメント/archive/legacy-code/
├── lambda-functions/
│   ├── src/functions/        # Lambda関数のコード
│   ├── serverless.yml        # Serverless設定
│   └── webpack.config.js     # Lambda用ビルド設定
└── dynamodb-code/            # DynamoDB関連コード（該当する場合）
```

### 保持するコード

以下のコードは保持（参考用または将来の拡張用）：

- `backend/src/libs/` - 共通ライブラリ（将来の拡張用）
- `backend/src/types/` - 型定義（参考用）

## 📝 整理手順

### ステップ1: アーカイブディレクトリの作成

```bash
mkdir -p ドキュメント/archive/legacy-code/lambda-functions
```

### ステップ2: Lambda関数コードのアーカイブ

```bash
# Lambda関数のコードをアーカイブ
cp -r backend/src/functions ドキュメント/archive/legacy-code/lambda-functions/
cp backend/serverless.yml ドキュメント/archive/legacy-code/lambda-functions/
cp backend/webpack.config.js ドキュメント/archive/legacy-code/lambda-functions/

# アーカイブ完了後、元のファイルを削除（慎重に）
# rm -rf backend/src/functions
# rm backend/serverless.yml
# rm backend/webpack.config.js
```

### ステップ3: READMEの更新

アーカイブしたコードについて、READMEに記載：

```markdown
## 📦 アーカイブされたコード

Lambda関数のコードは `ドキュメント/archive/legacy-code/lambda-functions/` にアーカイブされています。
現在はExpress.js (`simple_final_api.js`) を使用しています。
```

## ⚠️ 注意事項

1. **削除前の確認**
   - アーカイブしたコードが本当に不要か確認
   - 将来の参考になる可能性がある場合は保持

2. **Git履歴の保持**
   - コードを削除してもGit履歴は残る
   - 必要に応じて `git log` で確認可能

3. **ドキュメントの更新**
   - アーカイブ後、関連ドキュメントを更新
   - 現在のアーキテクチャを正確に反映

## ✅ 整理完了チェックリスト

- [ ] アーカイブディレクトリの作成
- [ ] Lambda関数コードのアーカイブ
- [ ] READMEの更新
- [ ] 本番環境技術仕様書の更新
- [ ] 開発環境セットアップガイドの更新
- [ ] Gitコミット（アーカイブ作業の記録）

---

**ステータス**: 📋 整理方針確定  
**実行**: 手動で実行（慎重に）

